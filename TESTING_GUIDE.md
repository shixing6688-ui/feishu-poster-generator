# 飞书多维表海报生成器 - 测试指南

## 📋 前置准备

### 1. 安装 Node.js 和 npm

如果你的系统还没有安装 Node.js，请先安装：

**macOS:**
```bash
# 使用 Homebrew 安装
brew install node

# 或者从官网下载安装包
# https://nodejs.org/
```

**验证安装:**
```bash
node --version  # 应该显示 v14.0.0 或更高版本
npm --version   # 应该显示 6.0.0 或更高版本
```

### 2. 安装项目依赖

在项目根目录下运行：

```bash
# 安装生产依赖
npm install

# 安装开发依赖
npm install --save-dev webpack-dev-server html-webpack-plugin style-loader css-loader @types/react @types/react-dom

# 安装额外依赖
npm install uuid
npm install --save-dev @types/uuid

# 可选：安装 jszip 用于批量下载 ZIP
npm install jszip
```

## 🚀 启动开发服务器

### 方式一：使用 npm 脚本（推荐）

```bash
npm start
```

这将：
- 启动 webpack 开发服务器
- 自动打开浏览器访问 http://localhost:3000
- 启用热重载（修改代码后自动刷新）

### 方式二：手动启动

```bash
npx webpack serve --mode development
```

## 🧪 功能测试步骤

### 第一步：加载模拟数据

1. 打开浏览器访问 http://localhost:3000
2. 你会看到顶部有一个紫色渐变的导航栏
3. 在数据配置面板中，点击 **"加载模拟数据"** 按钮
4. 应该会弹出提示：`成功加载 5 条模拟数据`
5. 右上角会显示数据徽章：`已加载 5 条数据`

### 第二步：创建海报模板

1. 点击 **"+ 创建新模板"** 按钮
2. 进入模板设计器界面，包含三个区域：
   - 左侧：工具栏（添加元素）
   - 中间：画布（预览区域）
   - 右侧：属性面板

3. **添加背景元素：**
   - 点击左侧 "📄 背景" 按钮
   - 在右侧属性面板中设置背景颜色（例如：#f0f0f0）

4. **添加标题文本：**
   - 点击 "📝 文本" 按钮
   - 在右侧属性面板中：
     - 修改文本内容为 "{{标题}}"
     - 设置字段映射为 "title"
     - 调整字体大小为 32
     - 设置对齐方式为 "居中"
     - 调整位置：X=50, Y=50, 宽度=650, 高度=60

5. **添加图片元素：**
   - 点击 "🖼️ 图片" 按钮
   - 在右侧属性面板中：
     - 设置字段映射为 "image"（附件字段）
     - 选择填充模式为 "覆盖"
     - 设置圆角为 8
     - 调整位置：X=50, Y=130, 宽度=650, 高度=400

6. **添加内容文本：**
   - 再次点击 "📝 文本" 按钮
   - 设置：
     - 字段映射为 "content"
     - 字体大小为 16
     - 最大行数为 3
     - 位置：X=50, Y=550, 宽度=650, 高度=100

7. **添加标签元素：**
   - 点击 "🏷️ 标签" 按钮
   - 设置：
     - 字段映射为 "tags"
     - 背景颜色为 #667eea
     - 文字颜色为 #ffffff
     - 位置：X=50, Y=670, 宽度=650, 高度=50

8. **保存模板：**
   - 在顶部输入框中修改模板名称为 "活动海报模板"
   - 点击右上角 **"保存模板"** 按钮
   - 应该会弹出提示：`模板保存成功`

### 第三步：配置字段映射

1. 返回模板列表后，点击刚创建的模板卡片上的 **"使用"** 按钮
2. 进入字段映射配置界面
3. 你会看到所有可映射的元素列表
4. 为每个元素选择对应的飞书字段：
   - 文本元素 → 标题字段
   - 图片元素 → 封面图片字段
   - 文本元素 → 内容字段
   - 标签元素 → 标签字段
5. 底部会显示映射进度：`已映射: 4 / 4`

### 第四步：预览海报效果

1. 点击右上角 **"预览效果"** 按钮
2. 进入预览界面，你会看到：
   - 根据第一条数据生成的海报预览图
   - 顶部有切换按钮：← 上一个 | 1 / 5 | 下一个 →
3. 点击 "下一个" 按钮，查看不同数据的海报效果
4. 点击 **"下载预览图"** 按钮，可以下载当前预览的海报

### 第五步：批量生成海报

1. 点击右上角 **"批量生成"** 按钮
2. 在弹出的批量生成窗口中：
   - 看到所有 5 条数据记录
   - 勾选要生成海报的记录（或点击"全选"）
   - 点击 **"开始生成 (5)"** 按钮

3. 观察生成过程：
   - 进度条会实时更新
   - 显示 "正在生成海报... 3 / 5"

4. 生成完成后：
   - 看到成功统计：`总计: 5 | 成功: 5 | 失败: 0`
   - 结果列表显示每条记录的生成状态
   - 每条成功的记录旁边有 **"下载"** 按钮

5. 下载海报：
   - 点击单个 **"下载"** 按钮下载单张海报
   - 或点击 **"下载全部 (5)"** 按钮批量下载所有海报

## 🔍 测试检查点

### ✅ 基础功能
- [ ] 页面正常加载，无控制台错误
- [ ] 可以加载模拟数据
- [ ] 可以创建和保存模板
- [ ] 可以编辑已有模板
- [ ] 可以删除模板

### ✅ 模板设计器
- [ ] 可以添加各种元素（背景、文本、图片、标签）
- [ ] 可以选择和编辑元素
- [ ] 属性面板正确显示元素属性
- [ ] 可以调整元素位置和尺寸
- [ ] 可以设置字段映射

### ✅ 字段映射
- [ ] 正确显示可映射的元素
- [ ] 可以为元素选择字段
- [ ] 映射进度正确显示

### ✅ 预览功能
- [ ] 预览图正确生成
- [ ] 可以切换不同数据行
- [ ] 数据正确填充到模板中
- [ ] 图片正确加载和显示
- [ ] 标签正确显示

### ✅ 批量生成
- [ ] 可以选择要生成的记录
- [ ] 进度条正确更新
- [ ] 生成结果正确统计
- [ ] 可以下载单个海报
- [ ] 可以批量下载海报

## 🐛 常见问题

### 问题 1：npm 命令找不到
**解决方案：** 安装 Node.js，参考前置准备部分

### 问题 2：端口 3000 被占用
**解决方案：** 修改 webpack.config.js 中的端口号，或关闭占用 3000 端口的程序

### 问题 3：图片无法加载
**解决方案：** 检查网络连接，模拟数据使用的是 Unsplash 的图片，需要网络访问

### 问题 4：海报生成失败
**解决方案：** 
- 检查浏览器控制台的错误信息
- 确保所有字段都正确映射
- 检查图片 URL 是否有效

## 📝 测试报告模板

测试完成后，可以记录以下信息：

```
测试日期：____________________
测试人员：____________________
浏览器版本：__________________

功能测试结果：
- 数据加载：✅ / ❌
- 模板创建：✅ / ❌
- 字段映射：✅ / ❌
- 海报预览：✅ / ❌
- 批量生成：✅ / ❌
- 海报下载：✅ / ❌

发现的问题：
1. ________________________________
2. ________________________________

建议改进：
1. ________________________________
2. ________________________________
```

## 🎯 下一步

测试通过后，你可以：
1. 修改 `src/utils/mockData.ts` 中的 `USE_MOCK_DATA` 为 `false`
2. 配置真实的飞书 API Token 和 Table ID
3. 连接真实的飞书多维表进行测试
4. 根据实际需求调整模板和样式

